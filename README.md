# ğŸ˜· Mask-Detection: åŸºäº ResNet18 çš„æœ‰æ— å£ç½©è¯†åˆ«ç³»ç»Ÿ

> æœ¬é¡¹ç›®åˆ©ç”¨æ·±åº¦å­¦ä¹ æŠ€æœ¯ï¼Œé€šè¿‡è‡ªå®šä¹‰æ„å»ºçš„ **ResNet18** æ®‹å·®ç½‘ç»œï¼Œå®ç°å¯¹äººè„¸æ˜¯å¦ä½©æˆ´å£ç½©çš„è‡ªåŠ¨åŒ–æ£€æµ‹ã€‚é¡¹ç›®ä¸ä»…åŒ…å«å®Œæ•´çš„è®­ç»ƒä¸æµ‹è¯•æµç¨‹ï¼Œè¿˜å¼•å…¥äº† **Grad-CAM** çƒ­åŠ›å›¾æŠ€æœ¯æ¥åˆ†ææ¨¡å‹çš„å†³ç­–ä¾æ®ã€‚

![Python](https://img.shields.io/badge/Python-3.8+-blue)
![PyTorch](https://img.shields.io/badge/Framework-PyTorch-orange)
![License](https://img.shields.io/badge/License-MIT-green)

---

## ğŸ“‘ é¡¹ç›®æ¶æ„ä¸æ–‡ä»¶è¯´æ˜

é¡¹ç›®ä»£ç ç»“æ„ä¸¥è°¨ï¼Œæ¶µç›–äº†ä»æ•°æ®å¤„ç†åˆ°é«˜çº§å¯è§†åŒ–çš„å…¨è¿‡ç¨‹ï¼š

* **`model.py`**: æ ¸å¿ƒç®—æ³•æ–‡ä»¶ã€‚ä»é›¶å®ç°äº† `Residual` æ®‹å·®æ¨¡å—åŠå®Œæ•´çš„ `ResNet18` ç½‘ç»œç»“æ„ã€‚
* **`data_partitioning.py`**: æ•°æ®é¢„å¤„ç†å·¥å…·ã€‚è´Ÿè´£å°† `dataset` åŸå§‹å›¾ç‰‡æŒ‰ **9:1** çš„æ¯”ä¾‹è‡ªåŠ¨åˆ’åˆ†ä¸ºè®­ç»ƒé›† (`train`) ä¸æµ‹è¯•é›† (`test`)ã€‚
* **`mean_std.py`**: åƒç´ ç»Ÿè®¡è„šæœ¬ã€‚è®¡ç®—å…¨æ•°æ®é›†çš„å‡å€¼ä¸æ–¹å·®ï¼Œç”¨äºç”Ÿæˆç²¾å‡†çš„å½’ä¸€åŒ–å‚æ•°ã€‚
* **`train.py`**: æ¨¡å‹è®­ç»ƒå¼•æ“ã€‚ä½¿ç”¨ Adam ä¼˜åŒ–å™¨ï¼Œé€šè¿‡ `random_split` åˆ’åˆ†éªŒè¯é›†ï¼Œå¹¶å®æ—¶ç»˜åˆ¶ Loss å’Œ Acc æ›²çº¿ã€‚
* **`test_model.py`**: æ¨ç†è¯„ä¼°è„šæœ¬ã€‚æ”¯æŒå•å¼ å›¾åƒï¼ˆå¦‚ `7573.jpg_wh860.jpg`ï¼‰çš„é¢„æµ‹ï¼Œå…·å¤‡**åå½’ä¸€åŒ–**æ˜¾ç¤ºåŠ**ä¸­æ–‡æ ‡ç­¾**å¼¹çª—åŠŸèƒ½ã€‚
* **`cam_test.py`**: çƒ­åŠ›å›¾å¯è§†åŒ–ã€‚åˆ©ç”¨ Grad-CAM æŠ€æœ¯å±•ç¤ºæ¨¡å‹åœ¨è¯†åˆ«â€œæˆ´å£ç½©â€æˆ–â€œä¸æˆ´å£ç½©â€æ—¶ä¸»è¦å…³æ³¨çš„é¢éƒ¨åŒºåŸŸã€‚
* **`plot.py`**: æ•°æ®é›†é¢„è§ˆå·¥å…·ã€‚ç”¨äºæ‰¹é‡å±•ç¤ºç»è¿‡é¢„å¤„ç†ï¼ˆåŒ…å«åå½’ä¸€åŒ–ï¼‰åçš„è®­ç»ƒé›†æ ·æœ¬ã€‚

---

## ğŸš€ ç®—æ³•æ ¸å¿ƒç»†èŠ‚


### 1. æ¨¡å‹å®ç° (ResNet18)
ç›¸æ¯”ä¼ ç»Ÿçš„æ·±å±‚ç½‘ç»œï¼Œæœ¬é¡¹ç›®é‡‡ç”¨çš„æ®‹å·®ç»“æ„è§£å†³äº†æ·±å±‚ç½‘ç»œä¸­çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼š
* **è¾“å…¥å°ºå¯¸**: 224 x 224 (RGB)
* **åˆ†ç±»è¾“å‡º**: 2 ç±»ï¼ˆæˆ´å£ç½©ã€ä¸æˆ´å£ç½©ï¼‰
* **æ ¸å¿ƒç»“æ„**: åŒ…å« 4 ä¸ªæ®‹å·®å—ç»„ï¼ˆb2-b5ï¼‰ï¼Œæœ€ç»ˆé€šè¿‡å…¨å±€å¹³å‡æ± åŒ–å±‚è¾“å‡ºç‰¹å¾ã€‚

### 2. æ ‡å‡†åŒ–å‚æ•° (Normalization)
æ ¹æ® `mean_std.py` è®¡ç®—ç»“æœï¼Œæœ¬é¡¹ç›®åœ¨å…¨æµç¨‹ä¸­ç»Ÿä¸€ä½¿ç”¨ä»¥ä¸‹å‚æ•°ï¼š
* **Mean**: `[0.1726, 0.1515, 0.1427]`
* **Std**: `[0.0736, 0.0622, 0.0593]`

---

## ğŸ›  ä½¿ç”¨æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡æ•°æ®
å°†åŸå§‹å›¾ç‰‡æ”¾å…¥ `dataset` æ–‡ä»¶å¤¹ï¼Œè¿è¡Œè„šæœ¬è¿›è¡Œè‡ªåŠ¨åˆ’åˆ†ï¼š
```bash
python data_partitioning.py
```

### ç¬¬äºŒæ­¥ï¼šæ¨¡å‹è®­ç»ƒ
å¯åŠ¨è®­ç»ƒç¨‹åºï¼Œæœ€ä¼˜æ¨¡å‹æƒé‡å°†è‡ªåŠ¨ä¿å­˜ä¸º `best_model.pth`ï¼š
```bash
python train.py
```

### ç¬¬ä¸‰æ­¥ï¼šå¯è§†åŒ–æ¨ç†
è¿è¡Œæµ‹è¯•è„šæœ¬ï¼ŒæŸ¥çœ‹æ¨¡å‹å¯¹ç‰¹å®šå›¾ç‰‡çš„è¯†åˆ«ç»“æœåŠå¯è§†åŒ–å›¾åƒï¼š
```bash
python test_model.py
```

### ç¬¬å››æ­¥ï¼šæ¨¡å‹å¯è§£é‡Šæ€§åˆ†æ
ä½¿ç”¨ Grad-CAM æŸ¥çœ‹æ¨¡å‹å…³æ³¨ç‚¹ï¼š
```bash
python cam_test.py
```

---

## âš ï¸ æ³¨æ„ç‚¹
> * **è·¯å¾„é…ç½®**: `train.py` ä¸­çš„æƒé‡ä¿å­˜è·¯å¾„ç›®å‰ç¡¬ç¼–ç ä¸º `C:/Users/86159/Desktop/ResNet18-1/`ã€‚åœ¨ä¸åŒç”µè„‘è¿è¡Œå‰ï¼Œè¯·åŠ¡å¿…ä¿®æ”¹æ­¤è·¯å¾„æˆ–æ”¹ä¸ºç›¸å¯¹è·¯å¾„ `./best_model.pth`ã€‚
> * **ä¸­æ–‡æ˜¾ç¤º**: `test_model.py` ä¾èµ– `SimHei` å­—ä½“æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾ã€‚è‹¥åœ¨é Windows ç¯å¢ƒä¸‹è¿è¡Œå‡ºç°ä¹±ç ï¼Œè¯·æ›´æ¢ `plt.rcParams['font.family']` çš„è®¾ç½®ã€‚
> * **åå½’ä¸€åŒ–**: åœ¨è¿›è¡Œå›¾åƒå±•ç¤ºæ—¶ï¼Œä»£ç å·²å†…ç½®åå½’ä¸€åŒ–é€»è¾‘ï¼Œç¡®ä¿æ˜¾ç¤ºçš„å›¾ç‰‡é¢œè‰²ä¸åŸå›¾ä¸€è‡´ã€‚

---

## ğŸ“¦ ç¯å¢ƒä¾èµ–
* python==3.8
* pytorch==1.10.1
* Cudatookit==11.3
* Cudnn==8.2
* torchsummary==1.5.1
* numpy==1.23.2
* pandas==3.5.0
* sklearn==0.0
